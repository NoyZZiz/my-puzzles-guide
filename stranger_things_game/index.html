<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="doc_title">Code Name: Hawkins - ROL Operator Assignment</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700&family=Inter:wght@400;500;600&family=Bebas+Neue&display=swap" rel="stylesheet">
    
    <style>
        /* BASE THEME & FONTS */
        .st-font { font-family: 'Bebas Neue', sans-serif; }
        .tech-font { font-family: 'Rajdhani', sans-serif; }

        body {
            background-color: #000000;
            color: #f7f7f7;
            font-family: 'Inter', sans-serif;
            line-height: 1.75; 
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            /* Upside Down Texture */
            background-image: radial-gradient(ellipse at center, rgba(30, 0, 0, 0.2) 0%, rgba(0, 0, 0, 1) 100%);
            background-size: cover;
        }
        
        /* THE ICONIC RED GLOW */
        .st-title {
            font-family: 'Bebas Neue', sans-serif;
            color: #d1121c;
            text-shadow: 
                0 0 5px rgba(209, 18, 28, 0.7), 
                0 0 10px rgba(209, 18, 28, 0.6), 
                0 0 20px rgba(209, 18, 28, 0.5);
            letter-spacing: 0.2em;
        }

        /* MAIN PANEL */
        .game-panel {
            background-color: rgba(10, 0, 0, 0.85);
            border: 3px solid #330000;
            box-shadow: 0 0 60px rgba(209, 18, 28, 0.5);
            border-radius: 10px;
            position: relative;
        }
        /* VCR Accent Lines */
        .game-panel::before, .game-panel::after {
            content: '';
            position: absolute;
            height: 1px;
            left: 10%;
            right: 10%;
            background: repeating-linear-gradient(to right, 
                #d1121c, #d1121c 2px, 
                transparent 2px, transparent 6px);
            opacity: 0.4;
        }
        .game-panel::before { top: 10px; }
        .game-panel::after { bottom: 10px; }
        
        /* INPUTS and SELECT */
        input[type="text"], select {
            background-color: #1a0000;
            border: 1px solid #d1121c;
            color: #ffcc00; 
            padding: 12px;
            border-radius: 4px;
            font-family: 'Rajdhani', monospace;
            font-size: 1rem;
        }
        input[type="text"]:focus, select:focus {
            border-color: #ffcc00;
            box-shadow: 0 0 10px rgba(255, 204, 0, 0.8);
            outline: none;
        }
        
        /* TRANSLATOR STYLING */
        #lang-selector {
            padding: 6px 10px;
            font-size: 0.8rem;
            background-color: #1a0000;
            border: 1px solid #d1121c;
            color: #ffcc00; 
            border-radius: 4px;
            font-family: 'Rajdhani', sans-serif;
            text-transform: uppercase;
        }

        /* BUTTONS */
        .spin-button {
            background-color: #d1121c; 
            color: #f7f7f7;
            font-weight: 700;
            padding: 15px 30px;
            border-radius: 6px;
            font-family: 'Rajdhani', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            box-shadow: 0 0 10px rgba(209, 18, 28, 0.3);
            transition: all 0.2s;
        }

        /* RESULT DISPLAY */
        #result-name {
            font-size: 3.5rem;
            color: #d1121c;
            text-shadow: 0 0 10px rgba(209, 18, 28, 0.8);
            font-family: 'Bebas Neue', sans-serif;
            letter-spacing: 0.3em;
        }
        
        /* STATUS MESSAGES (THEME OVERRIDE) */
        .status-info { background-color: rgba(50, 0, 0, 0.7); border: 1px solid #d1121c; color: #ffcc00; }
        .status-error { background-color: rgba(100, 0, 0, 0.7); border: 1px solid #ff333d; color: #f7f7f7; }
        .status-success { background-color: rgba(0, 50, 0, 0.7); border: 1px solid #32cd32; color: #90ee90; }
        .status-warning { background-color: rgba(50, 50, 0, 0.7); border: 1px solid #ffcc00; color: #ffcc00; }
        
        /* SCROLLBAR for roster */
        #castle-assignments::-webkit-scrollbar { width: 8px; }
        #castle-assignments::-webkit-scrollbar-thumb { background-color: #d1121c; border-radius: 4px; }
        
        /* THEME MODAL STYLING */
        #theme-modal {
            background-color: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(4px);
            transition: opacity 0.3s ease;
        }
        .modal-content {
            background-color: rgba(10, 0, 0, 0.95);
            border: 3px solid #d1121c;
            box-shadow: 0 0 25px rgba(209, 18, 28, 0.8);
            border-radius: 8px;
        }
        
        /* CRAZY ANIMATION FOR SPINNER */
        .glitch-anim {
            animation: glitch 1.5s linear infinite alternate, shake 0.15s infinite;
        }

        @keyframes glitch {
            0% { text-shadow: 0 0 5px rgba(255, 0, 0, 0.7); transform: translate(1px, 1px); }
            50% { text-shadow: 0 0 5px rgba(0, 255, 0, 0.7); transform: translate(-1px, -1px); }
            100% { text-shadow: 0 0 5px rgba(0, 0, 255, 0.7); transform: translate(0, 0); }
        }

        @keyframes shake {
            0% { transform: translate(1px, 0); }
            100% { transform: translate(-1px, 0); }
        }

    </style>
</head>
<body class="antialiased">

    <header class="w-full bg-black/90">
        <div class="container mx-auto px-4 py-3 flex items-center justify-between">
            <a href="#" class="text-xl font-bold st-title flex items-center tracking-wider">
                <i class="fa-solid fa-bolt mr-2 text-red-600" style="text-shadow: 0 0 5px #d1121c;"></i> 
                NOYZZING // OPS
            </a>
            <div class="flex items-center space-x-4">
                <select id="lang-selector"></select>
                
                <div class="text-sm font-semibold tech-font text-red-500 uppercase tracking-wider">
                    Alliance: **ROL**
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-10 flex-grow flex items-center justify-center">
        
        <div class="game-panel w-full max-w-2xl p-6 md:p-10">
            <h1 class="text-4xl md:text-6xl text-center mb-1 uppercase tracking-wider st-title">
                Code Name: HAWKINS
            </h1>
            <p class="text-center text-red-700 mb-8 text-sm uppercase tracking-wider font-semibold tech-font" data-i18n="castle_title">
                HAWKINS CHARACTER ASSIGNMENT DATABASE
            </p>

            <div id="status-message" class="status-info p-3 rounded-lg mb-6">
                <i class="fa-solid fa-circle-info mr-2"></i> Select your castle name to begin assignment.
            </div>

            <div id="castle-selection" class="space-y-4">
                <p class="text-sm text-gray-300 mb-4 tech-font" data-i18n="select_castle_prompt">Enter your unique castle identifier (e.g., Main, Alt 1)</p>
                <div class="space-y-4">
                    <div>
                        <label for="castle-input" class="block text-sm font-medium text-red-400 mb-1" data-i18n="castle_label">Castle Identifier:</label>
                        <input type="text" id="castle-input" placeholder="ROL | Alt Castle" maxlength="30" required>
                    </div>
                    <button id="select-castle-btn" class="spin-button w-full" data-i18n="access_file">
                        <i class="fa-solid fa-chess-rook mr-2"></i> ACCESS CASTLE FILE
                    </button>
                </div>
                
                <div class="mt-6 p-4 border border-red-600 rounded-lg bg-red-900/20">
                    <h3 class="text-red-400 font-bold mb-2" data-i18n="info_important">ğŸ’¡ IMPORTANT:</h3>
                    <p class="text-xs text-gray-300" data-i18n="info_resets">Each unique identifier gets **10 re-roll attempts** maximum. Use this name for all future checks on this castle.</p>
                </div>
            </div>

            <div id="assignment-form" class="space-y-4 hidden">
                
                <div id="castle-info" class="bg-gray-900/50 border border-red-900 text-gray-400 p-3 rounded-lg text-xs font-mono">
                    <p class="font-bold text-red-400 mb-1" data-i18n="active_alias">ACTIVE CASTLE/OPERATOR ALIAS: <span id="current-castle">None</span></p>
                    <p><span class="text-red-500" data-i18n="resets_left">Resets Left:</span> <span id="reset-count-display">10</span>/10</p>
                </div>

                <p class="text-sm text-gray-300 mb-4 tech-font"><span data-i18n="pool_prompt">Select the character pool for</span> <span id="castle-name" class="text-red-400">your castle</span></p>
                
                <div class="grid grid-cols-1 gap-4">
                    <div>
                        <label for="player-gender" class="block text-sm font-medium text-red-400 mb-1" data-i18n="char_pool_select">Character Pool Selection:</label>
                        <select id="player-gender" required>
                            <option value="" disabled selected data-i18n="select_default">-- Select --</option>
                            <option value="Male" data-i18n="male_chars">Male Characters</option>
                            <option value="Female" data-i18n="female_chars">Female Characters</option>
                        </select>
                    </div>
                </div>

                <div class="pt-4">
                    <button id="assign-btn" class="spin-button w-full" data-i18n="assign_code">
                        <i class="fa-solid fa-mask mr-2"></i> ASSIGN CODE NAME
                    </button>
                </div>
            </div>

            <div id="spinner-container" class="mt-8 flex items-center justify-center p-6 hidden">
                <span id="spinner-text" class="st-title text-4xl" data-i18n-spinner="SEARCHING REALITY...">SEARCHING REALITY...</span>
            </div>

            <div id="result-display" class="mt-8 text-center hidden p-6 border-2 border-red-900 rounded-lg">
                <h3 class="text-lg text-gray-300 font-medium uppercase tracking-wider mb-2 tech-font" data-i18n="assignment_secured">CASTLE ASSIGNMENT SECURED:</h3>
                <p id="result-name" class="font-bold"></p>
                <p id="result-char-type" class="text-sm text-red-600 mt-2 font-mono"></p>
                
                <div class="space-y-2 mt-6">
                    <button id="share-btn" class="spin-button w-full bg-yellow-600 hover:bg-yellow-700 text-black text-xs" data-i18n="copy_details">
                        <i class="fa-solid fa-share-nodes mr-1"></i> COPY ASSIGNMENT DETAILS
                    </button>
                    <button id="reset-btn" class="spin-button w-full bg-red-800 hover:bg-red-900 text-xs" data-i18n="reset_reroll">
                        <i class="fa-solid fa-radiation mr-1"></i> RESET & RE-ROLL (<span id="reset-count">10</span> LEFT)
                    </button>
                    <button id="new-castle-btn" class="spin-button w-full bg-gray-600 hover:bg-gray-700 text-xs" data-i18n="change_new_castle">
                        <i class="fa-solid fa-chess-rook mr-1"></i> CHANGE / NEW CASTLE
                    </button>
                </div>
            </div>
            
            <div class="mt-10">
                <h2 class="text-2xl st-title mb-3 border-b border-red-900 pb-1" data-i18n="log_title">
                    <i class="fa-solid fa-chess-rook text-red-500 mr-2"></i> ROL CASTLE ASSIGNMENT LOG
                </h2>
                <div id="castle-assignments" class="text-sm text-gray-400 space-y-2 max-h-60 overflow-y-auto p-3 font-mono">
                    </div>
            </div>
        </div>

    </main>

    <footer class="w-full text-center text-gray-600 text-xs py-4 bg-black/50">
        &copy; 2025 Noyzzing | ROL Alliance | D.O.E. File 001
    </footer>
    
    <div id="theme-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 hidden opacity-0 transition-opacity">
        <div class="modal-content w-full max-w-sm p-6 relative">
            
            <h3 id="modal-title" class="st-title text-2xl mb-4 uppercase" data-i18n="modal_override_title">WARNING: CLASSIFIED OPERATION</h3>
            
            <p id="modal-message" class="text-gray-300 text-sm mb-6 tech-font">
                </p>
            
            <div class="flex justify-end space-x-3">
                <button id="modal-cancel" class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded text-sm tech-font" data-i18n="cancel_btn">
                    CANCEL
                </button>
                <button id="modal-confirm" class="bg-red-700 hover:bg-red-800 text-white font-bold py-2 px-4 rounded text-sm tech-font" data-i18n="confirm_reroll_btn">
                    CONFIRM RE-ROLL
                </button>
            </div>
        </div>
    </div>
    <script>
        // --- TRANSLATION DATA (i18n) ---
        const TRANSLATIONS = {
            'en': {
                'lang_name': 'English', 'doc_title': 'Code Name: Hawkins - ROL Operator Assignment', 
                'castle_title': 'HAWKINS CHARACTER ASSIGNMENT DATABASE',
                'select_castle_prompt': 'Enter your unique castle identifier (e.g., Main, Alt 1)', 'castle_label': 'Castle Identifier:',
                'access_file': 'ACCESS CASTLE FILE', 'info_important': 'ğŸ’¡ IMPORTANT:',
                'info_resets': 'Each unique identifier gets **10 re-roll attempts** maximum. Use this name for all future checks on this castle.',
                'active_alias': 'ACTIVE CASTLE/OPERATOR ALIAS:', 'resets_left': 'Resets Left:',
                'pool_prompt': 'Select the character pool for', 'char_pool_select': 'Character Pool Selection:',
                'select_default': '-- Select --', 'male_chars': 'Male Characters', 'female_chars': 'Female Characters',
                'assign_code': '<i class="fa-solid fa-mask mr-2"></i> ASSIGN CODE NAME',
                'assignment_secured': 'CASTLE ASSIGNMENT SECURED:',
                'copy_details': '<i class="fa-solid fa-share-nodes mr-1"></i> COPY ASSIGNMENT DETAILS',
                'reset_reroll': '<i class="fa-solid fa-radiation mr-1"></i> RESET & RE-ROLL',
                'change_new_castle': '<i class="fa-solid fa-chess-rook mr-1"></i> CHANGE / NEW CASTLE',
                'log_title': '<i class="fa-solid fa-chess-rook text-red-500 mr-2"></i> ROL CASTLE ASSIGNMENT LOG',
                'modal_override_title': 'WARNING: CLASSIFIED OPERATION',
                'cancel_btn': 'CANCEL', 'confirm_reroll_btn': 'CONFIRM RE-ROLL',
                'status_default': 'Select your castle name to begin assignment.', 
                'status_enter_name': 'Please enter a castle name.', 'status_select_pool': 'Please select a character pool.',
                'status_assignment_exists': 'Assignment already completed. Use Reset to re-roll.',
                'status_ready': 'Selected "$1". Ready for assignment.',
                'status_no_resets': 'âŒ No reset attempts remaining for this castle.',
                'status_reset_confirm_msg': 'This will consume **1 of your $1 re-roll attempts** for **$2**. The current code name will be lost.',
                'status_reset_cancel': 'Re-roll cancelled. Current assignment remains active.',
                'status_reset_complete': 'Reset complete. $1 attempt(s) remaining for "$2".',
                'status_new_castle': 'Enter a new or existing castle name to proceed.',
                'status_copy_success': 'Copied to clipboard! Share this assignment in Discord.',
                'status_duplicate_warning': 'All unique characters used for this castle! Allowing duplicates.',
                'spinner_searching': 'SEARCHING REALITY...', 'spinner_upside_down': 'SEARCHING THE UPSIDE DOWN',
                'spinner_initiating': '<i class="fa-solid fa-spinner fa-spin mr-2"></i> INITIATING SEARCH...',
                'result_welcome': 'Welcome back! **$1** assigned to $2',
                'result_secured': 'Assignment complete! **$1** secured.',
                'result_failed': 'Assignment failed. Try again.',
                'roster_empty': 'No castle assignments found locally.'
            },
            'ru': {
                'lang_name': 'Ğ ÑƒÑÑĞºĞ¸Ğ¹', 'doc_title': 'ĞšĞ¾Ğ´Ğ¾Ğ²Ğ¾Ğµ Ğ¸Ğ¼Ñ: Ğ¥Ğ¾ĞºĞ¸Ğ½Ñ â€” ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€Ğ° ROL',
                'castle_title': 'Ğ‘ĞĞ—Ğ Ğ”ĞĞĞĞ«Ğ¥ ĞĞĞ—ĞĞĞ§Ğ•ĞĞ˜Ğ™ ĞŸĞ•Ğ Ğ¡ĞĞĞĞ–Ğ•Ğ™ HAWKINS',
                'select_castle_prompt': 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€ Ğ²Ğ°ÑˆĞµĞ³Ğ¾ Ğ·Ğ°Ğ¼ĞºĞ° (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, Main, Alt 1)', 'castle_label': 'Ğ˜Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€ Ğ—Ğ°Ğ¼ĞºĞ°:',
                'access_file': 'Ğ”ĞĞ¡Ğ¢Ğ£ĞŸ Ğš Ğ¤ĞĞ™Ğ›Ğ£ Ğ—ĞĞœĞšĞ', 'info_important': 'ğŸ’¡ Ğ’ĞĞ–ĞĞ:',
                'info_resets': 'ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ Ğ¼Ğ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ **10 Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğº Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€Ğ½Ğ¾Ğ³Ğ¾ Ğ±Ñ€Ğ¾ÑĞºĞ°**. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ ÑÑ‚Ğ¾ Ğ¸Ğ¼Ñ Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ±ÑƒĞ´ÑƒÑ‰Ğ¸Ñ… Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¾Ğº ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ¼ĞºĞ°.',
                'active_alias': 'ĞĞšĞ¢Ğ˜Ğ’ĞĞ«Ğ™ Ğ—ĞĞœĞĞš/ĞŸĞ¡Ğ•Ğ’Ğ”ĞĞĞ˜Ğœ ĞĞŸĞ•Ğ ĞĞ¢ĞĞ Ğ:', 'resets_left': 'ĞÑÑ‚Ğ°Ğ»Ğ¾ÑÑŒ ÑĞ±Ñ€Ğ¾ÑĞ¾Ğ²:',
                'pool_prompt': 'Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¿ÑƒĞ» Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶ĞµĞ¹ Ğ´Ğ»Ñ', 'char_pool_select': 'Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ¿ÑƒĞ»Ğ° Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶ĞµĞ¹:',
                'select_default': '-- Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ --', 'male_chars': 'ĞœÑƒĞ¶ÑĞºĞ¸Ğµ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶Ğ¸', 'female_chars': 'Ğ–ĞµĞ½ÑĞºĞ¸Ğµ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶Ğ¸',
                'assign_code': '<i class="fa-solid fa-mask mr-2"></i> ĞĞĞ—ĞĞĞ§Ğ˜Ğ¢Ğ¬ ĞšĞĞ”ĞĞ’ĞĞ• Ğ˜ĞœĞ¯',
                'assignment_secured': 'ĞĞĞ—ĞĞĞ§Ğ•ĞĞ˜Ğ• Ğ—ĞĞœĞšĞ Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ:',
                'copy_details': '<i class="fa-solid fa-share-nodes mr-1"></i> ĞšĞĞŸĞ˜Ğ ĞĞ’ĞĞ¢Ğ¬ Ğ”Ğ•Ğ¢ĞĞ›Ğ˜',
                'reset_reroll': '<i class="fa-solid fa-radiation mr-1"></i> Ğ¡Ğ‘Ğ ĞĞ¡Ğ˜Ğ¢Ğ¬ Ğ˜ ĞŸĞĞ’Ğ¢ĞĞ ĞĞ Ğ‘Ğ ĞĞ¡Ğ˜Ğ¢Ğ¬',
                'change_new_castle': '<i class="fa-solid fa-chess-rook mr-1"></i> Ğ˜Ğ—ĞœĞ•ĞĞ˜Ğ¢Ğ¬ / ĞĞĞ’Ğ«Ğ™ Ğ—ĞĞœĞĞš',
                'log_title': '<i class="fa-solid fa-chess-rook text-red-500 mr-2"></i> Ğ–Ğ£Ğ ĞĞĞ› ĞĞĞ—ĞĞĞ§Ğ•ĞĞ˜Ğ™ Ğ—ĞĞœĞšĞ ROL',
                'modal_override_title': 'Ğ’ĞĞ˜ĞœĞĞĞ˜Ğ•: Ğ¡Ğ•ĞšĞ Ğ•Ğ¢ĞĞĞ¯ ĞĞŸĞ•Ğ ĞĞ¦Ğ˜Ğ¯',
                'cancel_btn': 'ĞĞ¢ĞœĞ•ĞĞ', 'confirm_reroll_btn': 'ĞŸĞĞ”Ğ¢Ğ’Ğ•Ğ Ğ”Ğ˜Ğ¢Ğ¬ ĞŸĞĞ’Ğ¢ĞĞ ĞĞ«Ğ™ Ğ‘Ğ ĞĞ¡ĞĞš',
                'status_default': 'Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¸Ğ¼Ñ ÑĞ²Ğ¾ĞµĞ³Ğ¾ Ğ·Ğ°Ğ¼ĞºĞ°, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ.', 
                'status_enter_name': 'ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¸Ğ¼Ñ Ğ·Ğ°Ğ¼ĞºĞ°.', 'status_select_pool': 'ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¿ÑƒĞ» Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶ĞµĞ¹.',
                'status_assignment_exists': 'ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ ÑƒĞ¶Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¾. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ Ğ¡Ğ±Ñ€Ğ¾Ñ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€Ğ½Ğ¾Ğ³Ğ¾ Ğ±Ñ€Ğ¾ÑĞºĞ°.',
                'status_ready': 'Ğ’Ñ‹Ğ±Ñ€Ğ°Ğ½ "$1". Ğ“Ğ¾Ñ‚Ğ¾Ğ² Ğº Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ.',
                'status_no_resets': 'âŒ ĞŸĞ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğº ÑĞ±Ñ€Ğ¾ÑĞ° Ğ´Ğ»Ñ ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ¼ĞºĞ° Ğ½Ğµ Ğ¾ÑÑ‚Ğ°Ğ»Ğ¾ÑÑŒ.',
                'status_reset_confirm_msg': 'Ğ­Ñ‚Ğ¾ Ğ¿Ğ¾Ñ‚Ñ€Ğ°Ñ‚Ğ¸Ñ‚ **1 Ğ¸Ğ· Ğ²Ğ°ÑˆĞ¸Ñ… $1 Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğº Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€Ğ½Ğ¾Ğ³Ğ¾ Ğ±Ñ€Ğ¾ÑĞºĞ°** Ğ´Ğ»Ñ **$2**. Ğ¢ĞµĞºÑƒÑ‰ĞµĞµ ĞºĞ¾Ğ´Ğ¾Ğ²Ğ¾Ğµ Ğ¸Ğ¼Ñ Ğ±ÑƒĞ´ĞµÑ‚ Ğ¿Ğ¾Ñ‚ĞµÑ€ÑĞ½Ğ¾.',
                'status_reset_cancel': 'ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€Ğ½Ñ‹Ğ¹ Ğ±Ñ€Ğ¾ÑĞ¾Ğº Ğ¾Ñ‚Ğ¼ĞµĞ½ĞµĞ½. Ğ¢ĞµĞºÑƒÑ‰ĞµĞµ Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¾ÑÑ‚Ğ°ĞµÑ‚ÑÑ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¼.',
                'status_reset_complete': 'Ğ¡Ğ±Ñ€Ğ¾Ñ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½. ĞÑÑ‚Ğ°Ğ»Ğ¾ÑÑŒ $1 Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğº Ğ´Ğ»Ñ "$2".',
                'status_new_castle': 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ½Ğ¾Ğ²Ğ¾Ğµ Ğ¸Ğ»Ğ¸ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ĞµĞµ Ğ¸Ğ¼Ñ Ğ·Ğ°Ğ¼ĞºĞ° Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½Ğ¸Ñ.',
                'status_copy_success': 'Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾ Ğ² Ğ±ÑƒÑ„ĞµÑ€ Ğ¾Ğ±Ğ¼ĞµĞ½Ğ°! ĞŸĞ¾Ğ´ĞµĞ»Ğ¸Ñ‚ĞµÑÑŒ ÑÑ‚Ğ¸Ğ¼ Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸ĞµĞ¼ Ğ² Discord.',
                'status_duplicate_warning': 'Ğ’ÑĞµ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ñ‹ Ğ´Ğ»Ñ ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ¼ĞºĞ°! Ğ Ğ°Ğ·Ñ€ĞµÑˆĞ°ÑÑ‚ÑÑ Ğ´ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚Ñ‹.',
                'spinner_searching': 'ĞŸĞĞ˜Ğ¡Ğš Ğ Ğ•ĞĞ›Ğ¬ĞĞĞ¡Ğ¢Ğ˜...', 'spinner_upside_down': 'ĞŸĞĞ˜Ğ¡Ğš Ğ˜Ğ—ĞĞĞĞĞ§ĞĞĞ“Ğ ĞœĞ˜Ğ Ğ',
                'spinner_initiating': '<i class="fa-solid fa-spinner fa-spin mr-2"></i> ĞĞĞ§ĞĞ›Ğ ĞŸĞĞ˜Ğ¡ĞšĞ...',
                'result_welcome': 'Ğ¡ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸ĞµĞ¼! **$1** Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½ Ğ½Ğ° $2',
                'result_secured': 'ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¾! **$1** Ğ·Ğ°ĞºÑ€ĞµĞ¿Ğ»ĞµĞ½.',
                'result_failed': 'ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ½Ğµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ĞµÑ‰Ğµ Ñ€Ğ°Ğ·.',
                'roster_empty': 'Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ·Ğ°Ğ¼ĞºĞ¾Ğ² Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ñ‹.'
            },
            'pt': {
                'lang_name': 'PortuguÃªs', 'doc_title': 'Nome de CÃ³digo: Hawkins - AtribuiÃ§Ã£o de Operador ROL',
                'castle_title': 'BANCO DE DADOS DE ATRIBUIÃ‡ÃƒO DE PERSONAGENS DE HAWKINS',
                'select_castle_prompt': 'Insira seu identificador de castelo exclusivo (ex: Main, Alt 1)', 'castle_label': 'Identificador do Castelo:',
                'access_file': 'ACESSAR ARQUIVO DO CASTELO', 'info_important': 'ğŸ’¡ IMPORTANTE:',
                'info_resets': 'Cada identificador Ãºnico recebe um mÃ¡ximo de **10 tentativas de repetiÃ§Ã£o**. Use este nome para todas as futuras verificaÃ§Ãµes neste castelo.',
                'active_alias': 'CASTELO ATIVO/APELIDO DO OPERADOR:', 'resets_left': 'ReinicializaÃ§Ãµes Restantes:',
                'pool_prompt': 'Selecione o grupo de personagens para', 'char_pool_select': 'SeleÃ§Ã£o do Grupo de Personagens:',
                'select_default': '-- Selecionar --', 'male_chars': 'Personagens Masculinos', 'female_chars': 'Personagens Femininas',
                'assign_code': '<i class="fa-solid fa-mask mr-2"></i> ATRIBUIR NOME DE CÃ“DIGO',
                'assignment_secured': 'ATRIBUIÃ‡ÃƒO DO CASTELO GARANTIDA:',
                'copy_details': '<i class="fa-solid fa-share-nodes mr-1"></i> COPIAR DETALHES DA ATRIBUIÃ‡ÃƒO',
                'reset_reroll': '<i class="fa-solid fa-radiation mr-1"></i> REINICIAR E REPETIR',
                'change_new_castle': '<i class="fa-solid fa-chess-rook mr-1"></i> MUDAR / NOVO CASTELO',
                'log_title': '<i class="fa-solid fa-chess-rook text-red-500 mr-2"></i> REGISTRO DE ATRIBUIÃ‡ÃƒO DE CASTELO ROL',
                'modal_override_title': 'AVISO: OPERAÃ‡ÃƒO CLASSIFICADA',
                'cancel_btn': 'CANCELAR', 'confirm_reroll_btn': 'CONFIRMAR REPETIÃ‡ÃƒO',
                'status_default': 'Selecione o nome do seu castelo para iniciar a atribuiÃ§Ã£o.',
                'status_enter_name': 'Por favor, insira um nome de castelo.', 'status_select_pool': 'Por favor, selecione um grupo de personagens.',
                'status_assignment_exists': 'AtribuiÃ§Ã£o jÃ¡ concluÃ­da. Use Reiniciar para repetir.',
                'status_ready': 'Selecionado "$1". Pronto para atribuiÃ§Ã£o.',
                'status_no_resets': 'âŒ NÃ£o hÃ¡ tentativas de reinicializaÃ§Ã£o restantes para este castelo.',
                'status_reset_confirm_msg': 'Isso consumirÃ¡ **1 das suas $1 tentativas de repetiÃ§Ã£o** para **$2**. O nome de cÃ³digo atual serÃ¡ perdido.',
                'status_reset_cancel': 'RepetiÃ§Ã£o cancelada. A atribuiÃ§Ã£o atual permanece ativa.',
                'status_reset_complete': 'ReinicializaÃ§Ã£o concluÃ­da. Restam $1 tentativa(s) para "$2".',
                'status_new_castle': 'Insira um nome de castelo novo ou existente para continuar.',
                'status_copy_success': 'Copiado para a Ã¡rea de transferÃªncia! Compartilhe esta atribuiÃ§Ã£o no Discord.',
                'status_duplicate_warning': 'Todos os personagens Ãºnicos usados para este castelo! Duplicatas permitidas.',
                'spinner_searching': 'PESQUISANDO REALIDADE...', 'spinner_upside_down': 'PESQUISANDO O MUNDO INVERTIDO',
                'spinner_initiating': '<i class="fa-solid fa-spinner fa-spin mr-2"></i> INICIANDO PESQUISA...',
                'result_welcome': 'Bem-vindo de volta! **$1** atribuÃ­do a $2',
                'result_secured': 'AtribuiÃ§Ã£o completa! **$1** garantido.',
                'result_failed': 'AtribuiÃ§Ã£o falhou. Tente novamente.',
                'roster_empty': 'Nenhuma atribuiÃ§Ã£o de castelo encontrada localmente.'
            },
            'fr': {
                'lang_name': 'FranÃ§ais', 'doc_title': 'Nom de Code: Hawkins - Attribution d\'OpÃ©rateur ROL',
                'castle_title': 'BASE DE DONNÃ‰ES Dâ€™ATTRIBUTION DE PERSONNAGES HAWKINS',
                'select_castle_prompt': 'Entrez votre identifiant de chÃ¢teau unique (ex : Main, Alt 1)', 'castle_label': 'Identifiant du ChÃ¢teau:',
                'access_file': 'ACCÃ‰DER AU FICHIER DU CHÃ‚TEAU', 'info_important': 'ğŸ’¡ IMPORTANT:',
                'info_resets': 'Chaque identifiant unique dispose d\'un maximum de **10 tentatives de relance**. Utilisez ce nom pour toutes les futures vÃ©rifications sur ce chÃ¢teau.',
                'active_alias': 'CHÃ‚TEAU ACTIF/ALIAS OPÃ‰RATEUR:', 'resets_left': 'Relances Restantes:',
                'pool_prompt': 'SÃ©lectionnez le pool de personnages pour', 'char_pool_select': 'SÃ©lection du pool de personnages:',
                'select_default': '-- SÃ©lectionner --', 'male_chars': 'Personnages Masculins', 'female_chars': 'Personnages FÃ©minins',
                'assign_code': '<i class="fa-solid fa-mask mr-2"></i> ATTRIBUER UN NOM DE CODE',
                'assignment_secured': 'ATTRIBUTION DE CHÃ‚TEAU SÃ‰CURISÃ‰E:',
                'copy_details': '<i class="fa-solid fa-share-nodes mr-1"></i> COPIER LES DÃ‰TAILS DE L\'ATTRIBUTION',
                'reset_reroll': '<i class="fa-solid fa-radiation mr-1"></i> RÃ‰INITIALISER ET RELANCER',
                'change_new_castle': '<i class="fa-solid fa-chess-rook mr-1"></i> CHANGER / NOUVEAU CHÃ‚TEAU',
                'log_title': '<i class="fa-solid fa-chess-rook text-red-500 mr-2"></i> JOURNAL Dâ€™ATTRIBUTION DE CHÃ‚TEAUX ROL',
                'modal_override_title': 'AVERTISSEMENT: OPÃ‰RATION CLASSIFIÃ‰E',
                'cancel_btn': 'ANNULER', 'confirm_reroll_btn': 'CONFIRMER LA RELANCE',
                'status_default': 'SÃ©lectionnez le nom de votre chÃ¢teau pour commencer l\'attribution.',
                'status_enter_name': 'Veuillez entrer un nom de chÃ¢teau.', 'status_select_pool': 'Veuillez sÃ©lectionner un pool de personnages.',
                'status_assignment_exists': 'Attribution dÃ©jÃ  terminÃ©e. Utilisez RÃ©initialiser pour relancer.',
                'status_ready': 'SÃ©lectionnÃ© "$1". PrÃªt pour l\'attribution.',
                'status_no_resets': 'âŒ Aucune tentative de rÃ©initialisation restante pour ce chÃ¢teau.',
                'status_reset_confirm_msg': 'Ceci consommera **1 de vos $1 tentatives de relance** pour **$2**. Le nom de code actuel sera perdu.',
                'status_reset_cancel': 'Relance annulÃ©e. L\'attribution actuelle reste active.',
                'status_reset_complete': 'RÃ©initialisation terminÃ©e. $1 tentative(s) restante(s) pour "$2".',
                'status_new_castle': 'Entrez un nom de chÃ¢teau nouveau ou existant pour continuer.',
                'status_copy_success': 'CopiÃ© dans le presse-papiers! Partagez cette attribution dans Discord.',
                'status_duplicate_warning': 'Tous les personnages uniques utilisÃ©s pour ce chÃ¢teau! Les doublons sont autorisÃ©s.',
                'spinner_searching': 'RECHERCHE DE LA RÃ‰ALITÃ‰...', 'spinner_upside_down': 'RECHERCHE DE L\'UPSIDE DOWN',
                'spinner_initiating': '<i class="fa-solid fa-spinner fa-spin mr-2"></i> INITIALISATION DE LA RECHERCHE...',
                'result_welcome': 'Bienvenue de retour! **$1** attribuÃ© Ã  $2',
                'result_secured': 'Attribution complÃ¨te! **$1** sÃ©curisÃ©.',
                'result_failed': 'Attribution Ã©chouÃ©e. Veuillez rÃ©essayer.',
                'roster_empty': 'Aucune attribution de chÃ¢teau trouvÃ©e localement.'
            },
            'es': {
                'lang_name': 'EspaÃ±ol', 'doc_title': 'Nombre Clave: Hawkins - AsignaciÃ³n de Operador ROL',
                'castle_title': 'BASE DE DATOS DE ASIGNACIÃ“N DE PERSONAJES DE HAWKINS',
                'select_castle_prompt': 'Introduce tu identificador de castillo Ãºnico (ej: Main, Alt 1)', 'castle_label': 'Identificador del Castillo:',
                'access_file': 'ACCEDER AL ARCHIVO DEL CASTILLO', 'info_important': 'ğŸ’¡ IMPORTANTE:',
                'info_resets': 'Cada identificador Ãºnico tiene un mÃ¡ximo de **10 intentos de repeticiÃ³n**. Usa este nombre para todas las comprobaciones futuras en este castillo.',
                'active_alias': 'CASTILLO ACTIVO/ALIAS OPERADOR:', 'resets_left': 'Intentos Restantes:',
                'pool_prompt': 'Selecciona el grupo de personajes para', 'char_pool_select': 'SelecciÃ³n de Grupo de Personajes:',
                'select_default': '-- Seleccionar --', 'male_chars': 'Personajes Masculinos', 'female_chars': 'Personajes Femeninos',
                'assign_code': '<i class="fa-solid fa-mask mr-2"></i> ASIGNAR NOMBRE CLAVE',
                'assignment_secured': 'ASIGNACIÃ“N DE CASTILLO ASEGURADA:',
                'copy_details': '<i class="fa-solid fa-share-nodes mr-1"></i> COPIAR DETALLES DE ASIGNACIÃ“N',
                'reset_reroll': '<i class="fa-solid fa-radiation mr-1"></i> REINICIAR Y REPETIR',
                'change_new_castle': '<i class="fa-solid fa-chess-rook mr-1"></i> CAMBIAR / NUEVO CASTILLO',
                'log_title': '<i class="fa-solid fa-chess-rook text-red-500 mr-2"></i> REGISTRO DE ASIGNACIÃ“N DE CASTILLO ROL',
                'modal_override_title': 'ADVERTENCIA: OPERACIÃ“N CLASIFICADA',
                'cancel_btn': 'CANCELAR', 'confirm_reroll_btn': 'CONFIRMAR REPETICIÃ“N',
                'status_default': 'Selecciona el nombre de tu castillo para iniciar la asignaciÃ³n.',
                'status_enter_name': 'Por favor, introduce un nombre de castillo.', 'status_select_pool': 'Por favor, selecciona un grupo de personajes.',
                'status_assignment_exists': 'AsignaciÃ³n ya completada. Usa Reiniciar para repetir.',
                'status_ready': 'Seleccionado "$1". Listo para la asignaciÃ³n.',
                'status_no_resets': 'âŒ No quedan intentos de reinicio para este castillo.',
                'status_reset_confirm_msg': 'Esto consumirÃ¡ **1 de tus $1 intentos de repeticiÃ³n** para **$2**. El nombre clave actual se perderÃ¡.',
                'status_reset_cancel': 'RepeticiÃ³n cancelada. La asignaciÃ³n actual permanece activa.',
                'status_reset_complete': 'Reinicio completado. $1 intento(s) restante(s) para "$2".',
                'status_new_castle': 'Introduce un nombre de castillo nuevo o existente para continuar.',
                'status_copy_success': 'Â¡Copiado al portapapeles! Comparte esta asignaciÃ³n en Discord.',
                'status_duplicate_warning': 'Â¡Todos los personajes Ãºnicos utilizados para este castillo! Se permiten duplicados.',
                'spinner_searching': 'BUSCANDO REALIDAD...', 'spinner_upside_down': 'BUSCANDO EL MUNDO AL REVÃ‰S',
                'spinner_initiating': '<i class="fa-solid fa-spinner fa-spin mr-2"></i> INICIANDO BÃšSQUEDA...',
                'result_welcome': 'Â¡Bienvenido de nuevo! **$1** asignado a $2',
                'result_secured': 'Â¡AsignaciÃ³n completa! **$1** asegurado.',
                'result_failed': 'La asignaciÃ³n fallÃ³. IntÃ©ntalo de nuevo.',
                'roster_empty': 'No se encontraron asignaciones de castillo localmente.'
            },
            'de': {
                'lang_name': 'Deutsch', 'doc_title': 'Codename: Hawkins - ROL Operatorzuweisung',
                'castle_title': 'HAWKINS CHARAKTERZUWEISUNGSDATENBANK',
                'select_castle_prompt': 'Geben Sie Ihre eindeutige Burg-Kennung ein (z. B. Main, Alt 1)', 'castle_label': 'Burg-Kennung:',
                'access_file': 'AUF BURG-DATEI ZUGREIFEN', 'info_important': 'ğŸ’¡ WICHTIG:',
                'info_resets': 'Jede eindeutige Kennung erhÃ¤lt maximal **10 Neuversuche**. Verwenden Sie diesen Namen fÃ¼r alle zukÃ¼nftigen ÃœberprÃ¼fungen dieser Burg.',
                'active_alias': 'AKTIVE BURG/OPERATOR-ALIAS:', 'resets_left': 'Neustarts Ã¼brig:',
                'pool_prompt': 'WÃ¤hlen Sie den Charakterpool fÃ¼r', 'char_pool_select': 'Charakterpool-Auswahl:',
                'select_default': '-- AuswÃ¤hlen --', 'male_chars': 'MÃ¤nnliche Charaktere', 'female_chars': 'Weibliche Charaktere',
                'assign_code': '<i class="fa-solid fa-mask mr-2"></i> CODENAMEN ZUWEISEN',
                'assignment_secured': 'BURG-ZUWEISUNG GESICHERT:',
                'copy_details': '<i class="fa-solid fa-share-nodes mr-1"></i> ZUWEISUNGSDETAILS KOPIEREN',
                'reset_reroll': '<i class="fa-solid fa-radiation mr-1"></i> ZURÃœCKSETZEN & NEU WÃœRFELN',
                'change_new_castle': '<i class="fa-solid fa-chess-rook mr-1"></i> BURG WECHSELN / NEU',
                'log_title': '<i class="fa-solid fa-chess-rook text-red-500 mr-2"></i> ROL BURG-ZUWEISUNGSPROTOKOLL',
                'modal_override_title': 'WARNUNG: GEHEIME OPERATION',
                'cancel_btn': 'ABBRECHEN', 'confirm_reroll_btn': 'NEU WÃœRFELN BESTÃ„TIGEN',
                'status_default': 'WÃ¤hlen Sie Ihren Burgnamen, um die Zuweisung zu starten.',
                'status_enter_name': 'Bitte geben Sie einen Burgnamen ein.', 'status_select_pool': 'Bitte wÃ¤hlen Sie einen Charakterpool aus.',
                'status_assignment_exists': 'Zuweisung bereits abgeschlossen. Verwenden Sie ZurÃ¼cksetzen, um neu zu wÃ¼rfeln.',
                'status_ready': 'AusgewÃ¤hlt "$1". Bereit zur Zuweisung.',
                'status_no_resets': 'âŒ Keine Neustartversuche mehr fÃ¼r diese Burg Ã¼brig.',
                'status_reset_confirm_msg': 'Dies verbraucht **1 von Ihren $1 Neuversuchen** fÃ¼r **$2**. Der aktuelle Codename geht verloren.',
                'status_reset_cancel': 'NeuwÃ¼rfeln abgebrochen. Die aktuelle Zuweisung bleibt aktiv.',
                'status_reset_complete': 'ZurÃ¼cksetzung abgeschlossen. $1 Versuch(e) verbleiben fÃ¼r "$2".',
                'status_new_castle': 'Geben Sie einen neuen oder bestehenden Burgnamen ein, um fortzufahren.',
                'status_copy_success': 'In die Zwischenablage kopiert! Teilen Sie diese Zuweisung in Discord.',
                'status_duplicate_warning': 'Alle einzigartigen Charaktere fÃ¼r diese Burg verwendet! Duplikate erlaubt.',
                'spinner_searching': 'SUCHE REALITÃ„T...', 'spinner_upside_down': 'SUCHE IM UPSIDE DOWN',
                'spinner_initiating': '<i class="fa-solid fa-spinner fa-spin mr-2"></i> SUCHE WIRD INITIIERT...',
                'result_welcome': 'Willkommen zurÃ¼ck! **$1** zugewiesen an $2',
                'result_secured': 'Zuweisung abgeschlossen! **$1** gesichert.',
                'result_failed': 'Zuweisung fehlgeschlagen. Versuchen Sie es erneut.',
                'roster_empty': 'Keine lokalen Burg-Zuweisungen gefunden.'
            },
            'ja': {
                'lang_name': 'æ—¥æœ¬èª', 'doc_title': 'ã‚³ãƒ¼ãƒ‰ãƒãƒ¼ãƒ : ãƒ›ãƒ¼ã‚­ãƒ³ã‚¹ - ROLã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ã®å‰²ã‚Šå½“ã¦',
                'castle_title': 'ãƒ›ãƒ¼ã‚­ãƒ³ã‚¹ ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å‰²ã‚Šå½“ã¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹',
                'select_castle_prompt': 'å›ºæœ‰ã®ã‚­ãƒ£ãƒƒã‚¹ãƒ«è­˜åˆ¥å­ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ (ä¾‹: Main, Alt 1)', 'castle_label': 'ã‚­ãƒ£ãƒƒã‚¹ãƒ«è­˜åˆ¥å­:',
                'access_file': 'ã‚­ãƒ£ãƒƒã‚¹ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹', 'info_important': 'ğŸ’¡ é‡è¦:',
                'info_resets': 'å„å›ºæœ‰ã®è­˜åˆ¥å­ã¯ã€æœ€å¤§ã§**10å›ã®å†ãƒ­ãƒ¼ãƒ«è©¦è¡Œ**ã‚’å¾—ã¾ã™ã€‚ã“ã®åå‰ã‚’ã€ã“ã®ã‚­ãƒ£ãƒƒã‚¹ãƒ«ã«é–¢ã™ã‚‹ä»Šå¾Œã®ã™ã¹ã¦ã®ãƒã‚§ãƒƒã‚¯ã«ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚',
                'active_alias': 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚­ãƒ£ãƒƒã‚¹ãƒ«/ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚¨ã‚¤ãƒªã‚¢ã‚¹:', 'resets_left': 'æ®‹ã‚Šãƒªã‚»ãƒƒãƒˆå›æ•°:',
                'pool_prompt': 'ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ—ãƒ¼ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„', 'char_pool_select': 'ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ—ãƒ¼ãƒ«é¸æŠ:',
                'select_default': '-- é¸æŠ --', 'male_chars': 'ç”·æ€§ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼', 'female_chars': 'å¥³æ€§ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼',
                'assign_code': '<i class="fa-solid fa-mask mr-2"></i> ã‚³ãƒ¼ãƒ‰ãƒãƒ¼ãƒ ã‚’å‰²ã‚Šå½“ã¦ã‚‹',
                'assignment_secured': 'ã‚­ãƒ£ãƒƒã‚¹ãƒ«å‰²ã‚Šå½“ã¦ç¢ºä¿:',
                'copy_details': '<i class="fa-solid fa-share-nodes mr-1"></i> å‰²ã‚Šå½“ã¦ã®è©³ç´°ã‚’ã‚³ãƒ”ãƒ¼',
                'reset_reroll': '<i class="fa-solid fa-radiation mr-1"></i> ãƒªã‚»ãƒƒãƒˆã—ã¦å†ãƒ­ãƒ¼ãƒ«',
                'change_new_castle': '<i class="fa-solid fa-chess-rook mr-1"></i> ã‚­ãƒ£ãƒƒã‚¹ãƒ«ã‚’å¤‰æ›´/æ–°è¦ä½œæˆ',
                'log_title': '<i class="fa-solid fa-chess-rook text-red-500 mr-2"></i> ROL ã‚­ãƒ£ãƒƒã‚¹ãƒ«å‰²ã‚Šå½“ã¦ãƒ­ã‚°',
                'modal_override_title': 'è­¦å‘Š: æ©Ÿå¯†æ“ä½œ',
                'cancel_btn': 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«', 'confirm_reroll_btn': 'å†ãƒ­ãƒ¼ãƒ«ã‚’ç¢ºå®š',
                'status_default': 'å‰²ã‚Šå½“ã¦ã‚’é–‹å§‹ã™ã‚‹ãŸã‚ã«ã‚­ãƒ£ãƒƒã‚¹ãƒ«åã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚',
                'status_enter_name': 'ã‚­ãƒ£ãƒƒã‚¹ãƒ«åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚', 'status_select_pool': 'ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ—ãƒ¼ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚',
                'status_assignment_exists': 'å‰²ã‚Šå½“ã¦ã¯æ—¢ã«å®Œäº†ã—ã¦ã„ã¾ã™ã€‚ãƒªã‚»ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦å†ãƒ­ãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚',
                'status_ready': '"$1" ãŒé¸æŠã•ã‚Œã¾ã—ãŸã€‚å‰²ã‚Šå½“ã¦ã®æº–å‚™ãŒã§ãã¾ã—ãŸã€‚',
                'status_no_resets': 'âŒ ã“ã®ã‚­ãƒ£ãƒƒã‚¹ãƒ«ã«ã¯ãƒªã‚»ãƒƒãƒˆè©¦è¡ŒãŒæ®‹ã£ã¦ã„ã¾ã›ã‚“ã€‚',
                'status_reset_confirm_msg': 'ã“ã‚Œã«ã‚ˆã‚Šã€**$2** ã®**$1å›ã®å†ãƒ­ãƒ¼ãƒ«è©¦è¡Œ**ã®ã†ã¡1å›ãŒæ¶ˆè²»ã•ã‚Œã¾ã™ã€‚ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰ãƒãƒ¼ãƒ ã¯å¤±ã‚ã‚Œã¾ã™ã€‚',
                'status_reset_cancel': 'å†ãƒ­ãƒ¼ãƒ«ã¯ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸã€‚ç¾åœ¨ã®å‰²ã‚Šå½“ã¦ã¯æœ‰åŠ¹ãªã¾ã¾ã§ã™ã€‚',
                'status_reset_complete': 'ãƒªã‚»ãƒƒãƒˆãŒå®Œäº†ã—ã¾ã—ãŸã€‚"$2" ã®æ®‹ã‚Šè©¦è¡Œå›æ•°ã¯ $1 å›ã§ã™ã€‚',
                'status_new_castle': 'ç¶šè¡Œã™ã‚‹ã«ã¯ã€æ–°è¦ã¾ãŸã¯æ—¢å­˜ã®ã‚­ãƒ£ãƒƒã‚¹ãƒ«åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚',
                'status_copy_success': 'ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã•ã‚Œã¾ã—ãŸï¼Discordã§ã“ã®å‰²ã‚Šå½“ã¦ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚',
                'status_duplicate_warning': 'ã“ã®ã‚­ãƒ£ãƒƒã‚¹ãƒ«ã®å›ºæœ‰ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã¯ã™ã¹ã¦ä½¿ç”¨ã•ã‚Œã¾ã—ãŸ! é‡è¤‡ãŒè¨±å¯ã•ã‚Œã¾ã™ã€‚',
                'spinner_searching': 'ç¾å®Ÿã‚’æ¤œç´¢ä¸­...', 'spinner_upside_down': 'è£å´ã®ä¸–ç•Œã‚’æ¤œç´¢ä¸­...',
                'spinner_initiating': '<i class="fa-solid fa-spinner fa-spin mr-2"></i> æ¤œç´¢ã‚’åˆæœŸåŒ–ä¸­...',
                'result_welcome': 'ãŠã‹ãˆã‚Šãªã•ã„ï¼**$1** ãŒ $2 ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¾ã—ãŸ',
                'result_secured': 'å‰²ã‚Šå½“ã¦å®Œäº†ï¼**$1** ç¢ºä¿æ¸ˆã¿ã€‚',
                'result_failed': 'å‰²ã‚Šå½“ã¦ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦è©¦ã—ã¦ãã ã•ã„ã€‚',
                'roster_empty': 'ãƒ­ãƒ¼ã‚«ãƒ«ãªã‚­ãƒ£ãƒƒã‚¹ãƒ«å‰²ã‚Šå½“ã¦ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚'
            },
            'ko': {
                'lang_name': 'í•œêµ­ì–´', 'doc_title': 'ì½”ë“œëª…: í˜¸í‚¨ìŠ¤ - ROL ì˜¤í¼ë ˆì´í„° í• ë‹¹',
                'castle_title': 'í˜¸í‚¨ìŠ¤ ìºë¦­í„° í• ë‹¹ ë°ì´í„°ë² ì´ìŠ¤',
                'select_castle_prompt': 'ê³ ìœ í•œ ìºìŠ¬ ì‹ë³„ìë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: Main, Alt 1)', 'castle_label': 'ìºìŠ¬ ì‹ë³„ì:',
                'access_file': 'ìºìŠ¬ íŒŒì¼ ì ‘ê·¼', 'info_important': 'ğŸ’¡ ì¤‘ìš”:',
                'info_resets': 'ê° ê³ ìœ  ì‹ë³„ìëŠ” ìµœëŒ€ **10íšŒì˜ ì¬ì‹œë„ ê¸°íšŒ**ë¥¼ ê°–ìŠµë‹ˆë‹¤. ì´ ì´ë¦„ì€ í•´ë‹¹ ìºìŠ¬ì˜ í–¥í›„ ëª¨ë“  ê²€ì‚¬ì— ì‚¬ìš©ë©ë‹ˆë‹¤.',
                'active_alias': 'í™œì„± ìºìŠ¬/ì˜¤í¼ë ˆì´í„° ë³„ì¹­:', 'resets_left': 'ë‚¨ì€ ì¬ì‹œë„ íšŸìˆ˜:',
                'pool_prompt': 'ì˜ ìºë¦­í„° í’€ì„ ì„ íƒí•˜ì‹­ì‹œì˜¤', 'char_pool_select': 'ìºë¦­í„° í’€ ì„ íƒ:',
                'select_default': '-- ì„ íƒ --', 'male_chars': 'ë‚¨ì„± ìºë¦­í„°', 'female_chars': 'ì—¬ì„± ìºë¦­í„°',
                'assign_code': '<i class="fa-solid fa-mask mr-2"></i> ì½”ë“œëª… í• ë‹¹',
                'assignment_secured': 'ìºìŠ¬ í• ë‹¹ í™•ë³´:',
                'copy_details': '<i class="fa-solid fa-share-nodes mr-1"></i> í• ë‹¹ ì„¸ë¶€ ì •ë³´ ë³µì‚¬',
                'reset_reroll': '<i class="fa-solid fa-radiation mr-1"></i> ì¬ì„¤ì • ë° ì¬ì‹œë„',
                'change_new_castle': '<i class="fa-solid fa-chess-rook mr-1"></i> ìºìŠ¬ ë³€ê²½/ì‹ ê·œ',
                'log_title': '<i class="fa-solid fa-chess-rook text-red-500 mr-2"></i> ROL ìºìŠ¬ í• ë‹¹ ë¡œê·¸',
                'modal_override_title': 'ê²½ê³ : ê¸°ë°€ ì‘ì „',
                'cancel_btn': 'ì·¨ì†Œ', 'confirm_reroll_btn': 'ì¬ì‹œë„ í™•ì¸',
                'status_default': 'í• ë‹¹ì„ ì‹œì‘í•˜ë ¤ë©´ ìºìŠ¬ ì´ë¦„ì„ ì„ íƒí•˜ì„¸ìš”.',
                'status_enter_name': 'ìºìŠ¬ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'status_select_pool': 'ìºë¦­í„° í’€ì„ ì„ íƒí•´ì£¼ì„¸ìš”.',
                'status_assignment_exists': 'ì´ë¯¸ í• ë‹¹ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì¬ì„¤ì •ì„ ì‚¬ìš©í•˜ì—¬ ì¬ì‹œë„í•˜ì„¸ìš”.',
                'status_ready': '"$1" ì´(ê°€) ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤. í• ë‹¹ ì¤€ë¹„ ì™„ë£Œ.',
                'status_no_resets': 'âŒ ì´ ìºìŠ¬ì— ë‚¨ì€ ì¬ì„¤ì • ì‹œë„ íšŸìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.',
                'status_reset_confirm_msg': 'ì´ê²ƒì€ **$2**ì— ëŒ€í•œ **$1íšŒì˜ ì¬ì‹œë„ ê¸°íšŒ** ì¤‘ 1íšŒë¥¼ ì†Œëª¨í•©ë‹ˆë‹¤. í˜„ì¬ ì½”ë“œëª…ì€ ì†ì‹¤ë©ë‹ˆë‹¤.',
                'status_reset_cancel': 'ì¬ì‹œë„ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤. í˜„ì¬ í• ë‹¹ì€ í™œì„± ìƒíƒœë¥¼ ìœ ì§€í•©ë‹ˆë‹¤.',
                'status_reset_complete': 'ì¬ì„¤ì • ì™„ë£Œ. "$2" ì— $1 íšŒì˜ ì‹œë„ íšŸìˆ˜ê°€ ë‚¨ì•˜ìŠµë‹ˆë‹¤.',
                'status_new_castle': 'ê³„ì†í•˜ë ¤ë©´ ìƒˆ ìºìŠ¬ ì´ë¦„ ë˜ëŠ” ê¸°ì¡´ ìºìŠ¬ ì´ë¦„ì„ ì…ë ¥í•˜ì‹­ì‹œì˜¤.',
                'status_copy_success': 'í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! Discordì—ì„œ ì´ í• ë‹¹ì„ ê³µìœ í•˜ì‹­ì‹œì˜¤.',
                'status_duplicate_warning': 'ì´ ìºìŠ¬ì— ëŒ€í•œ ëª¨ë“  ê³ ìœ  ìºë¦­í„°ê°€ ì‚¬ìš©ë˜ì—ˆìŠµë‹ˆë‹¤! ì¤‘ë³µì´ í—ˆìš©ë©ë‹ˆë‹¤.',
                'spinner_searching': 'í˜„ì‹¤ ê²€ìƒ‰ ì¤‘...', 'spinner_upside_down': 'ë’¤ì§‘íŒ ì„¸ê³„ ê²€ìƒ‰ ì¤‘',
                'spinner_initiating': '<i class="fa-solid fa-spinner fa-spin mr-2"></i> ê²€ìƒ‰ ì´ˆê¸°í™” ì¤‘...',
                'result_welcome': 'ë‹¤ì‹œ ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤! **$1** ì´(ê°€) $2 ì— í• ë‹¹ë˜ì—ˆìŠµë‹ˆë‹¤',
                'result_secured': 'í• ë‹¹ ì™„ë£Œ! **$1** í™•ë³´.',
                'result_failed': 'í• ë‹¹ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•˜ì‹­ì‹œì˜¤.',
                'roster_empty': 'ë¡œì»¬ ìºìŠ¬ í• ë‹¹ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'
            }
        };
        
        // --- NEW i18n CORE FUNCTIONS ---
        let currentLang = localStorage.getItem('game_language') || 'en';
        
        function setLanguage(langCode) {
            const translations = TRANSLATIONS[langCode];
            if (!translations) return;

            currentLang = langCode;
            localStorage.setItem('game_language', langCode);
            
            // Set the document title (which is outside the body)
            document.title = translations['doc_title'] || 'Code Name: Hawkins';

            // 1. Translate all marked elements (data-i18n)
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[key]) {
                    // Use innerHTML to preserve font awesome icons or **bold** tags
                    el.innerHTML = translations[key];
                }
            });
            
            // 2. Translate spinner text (if needed)
            ELEMENTS.spinnerText.textContent = translations['spinner_searching'];

            // 3. Re-display status message using new language
            displayStatus('info', 'status_default');
            
            // Re-run translation on specific dynamic elements (e.g., if assignment result is showing)
            if (currentAssignment) {
                const isExisting = true; // Use a dummy true value to force status message update
                displayFinalResult(currentAssignment.characterName, currentAssignment.gender, isExisting);
            }
        }

        function setupLanguageSelector() {
            const selector = document.getElementById('lang-selector');
            const languages = Object.keys(TRANSLATIONS);
            
            selector.innerHTML = '';
            
            languages.forEach(langCode => {
                const option = document.createElement('option');
                option.value = langCode;
                option.textContent = TRANSLATIONS[langCode]['lang_name'];
                selector.appendChild(option);
            });
            
            // Set initial language (defaults to 'en')
            selector.value = currentLang;
            setLanguage(currentLang);

            selector.addEventListener('change', (e) => setLanguage(e.target.value));
        }
        
        // --- CONFIGURATION & CONSTANTS (rest of your original script) ---
        const DISCORD_WEBHOOK = 'https://discord.com/api/webhooks/1444330680858447903/dvcgQu42zAycH3rsEx8GADtmKoIGl3mY0PaznYMHhuOdtTlUHcliQJAk_No0NEtQ3Bg0';
        const STORAGE_KEY = 'rol_castle_assignments';
        const MAX_RESETS = 10; 

        // --- UPDATED AND VERIFIED CHARACTER ROSTER (130+ CHARACTERS, FILTERED) ---
       const CHARACTERS = {
            Male: [
                // Core Party/Teens
                'Mike Wheeler', 'Will Byers', 'Dustin Henderson', 'Lucas Sinclair', 'Jim Hopper',
                'Steve Harrington', 'Eddie Munson', 'Jonathan Byers', 'Argyle', 'Murray Bauman',
                // Secondary Heroes/Adults
                'Bob Newby', 'Ted Wheeler', 'Mr. Clarke', 'Billy Hargrove', 'Enzo (Dmitri)', 'Yuri Ismaylov',
                // Hawkins Residents / Side Characters
                'Jason Carver', 'Patrick McKinney', 'Fred Benson', 'Calvin Powell', 'Phillip Callahan', 
                'Tommy H.', 'Keith', 'Lonnie Byers', 'Benny Hammond', 'Mr. Harrington', 'Charles Sinclair',
                'Mr. Henderson', 'Mr. Wheeler', 'Mr. Mayfield', 'Mr. Munson', 'Scott Clarke', 'Greg', 'Rich',
                'Dr. Alexey', 'Alexi', 'Officer Callahan', 'Officer Powell', 'Mr. Baldo', 'Mr. Mooney',
                'Coach Skip', 'Mr. Sinclair', 'Mayor Larry Kline', 'Senator Hatch', 'Father Mike', 'Clyde',
                'Grigori', 'Gary', 'Tom Holloway', 'Brian', 'Derek Turnbow(Dipshit)'
            ],
            Female: [
                // Core Party/Teens
                'Eleven (El)', 'Max Mayfield', 'Nancy Wheeler', 'Robin Buckley', 'Joyce Byers', 
                'Erica Sinclair', 'Suzie Bingham', 'Kali Prasad (Eight)',
                // Secondary Heroes/Adults
                'Chrissy Cunningham', 'Angela', 'Vickie', 'Holly Wheeler', 'Tammy Thompson', 
                'Karen Wheeler', 'Claudia Henderson', 'Patty', 
                // Mothers / Residents
                'Mrs. Sinclair', 'Mrs. Byers', 'Mrs. Mayfield', 'Mrs. Munson', 'Mrs. Kelly',
                'Mrs. Driscoll', 'Anya', 'Sara Hopper', 'Janet Hayes', 'Florence',
                'Carol', 'Tina', 'Stacy', 'Melanie', 'Mrs. Reardon', 'Mrs. O\'Donnell',
                'Mrs. Bingley', 'Mrs. Harrington', 'Mrs. Coleman',
                // Added for completeness
                'Becky Ives', 'Sue', 'Dottie', 'Jen',
                'Barb', 'Heather Holloway', 'Terry Ives', 'Dr. Kay'
            ],
            Villain_Neutral: [
                // Monsters
                'Vecna (Henry Creel)', 
                'The Mind Flayer', 
                'Demogorgon', 
                'Demo-Dog', 
                // Human Antagonists
                'Peter Ballard (One)',
                'Dr. Brenner (Papa)', 
                'Dr. Owens', 
                'Lt. Colonel Sullivan', 
                'Connie Frazier', 
                'Agent Florence',
                // EPIC ADDITIONS
                'Grigori (Russian)', 'Antonov'
            ]
        };

        // --- GLOBAL STATE & ELEMENTS ---
        let currentCastle = null;
        let currentAssignment = null;

        const ELEMENTS = {
            castleSelection: document.getElementById('castle-selection'),
            assignmentForm: document.getElementById('assignment-form'),
            resultDisplay: document.getElementById('result-display'),
            resultName: document.getElementById('result-name'),
            resultCharType: document.getElementById('result-char-type'),
            assignBtn: document.getElementById('assign-btn'),
            resetBtn: document.getElementById('reset-btn'),
            shareBtn: document.getElementById('share-btn'),
            newCastleBtn: document.getElementById('new-castle-btn'),
            selectCastleBtn: document.getElementById('select-castle-btn'),
            castleInput: document.getElementById('castle-input'),
            playerGender: document.getElementById('player-gender'),
            statusMessage: document.getElementById('status-message'),
            currentCastle: document.getElementById('current-castle'),
            castleName: document.getElementById('castle-name'),
            resetCount: document.getElementById('reset-count'),
            resetCountDisplay: document.getElementById('reset-count-display'),
            castleAssignments: document.getElementById('castle-assignments'),
            
            // Spinner update
            spinnerContainer: document.getElementById('spinner-container'),
            spinnerText: document.getElementById('spinner-text'),

            // Modal Elements
            themeModal: document.getElementById('theme-modal'),
            modalTitle: document.getElementById('modal-title'),
            modalMessage: document.getElementById('modal-message'),
            modalConfirm: document.getElementById('modal-confirm'),
            modalCancel: document.getElementById('modal-cancel')
        };

        // --- LOCAL STORAGE HANDLERS ---
        function getCastleData(castle) {
            const allData = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
            const prevDefault = 6; // previous default resets used by older clients

            if (!allData[castle]) {
                allData[castle] = {
                    resetsLeft: MAX_RESETS,
                    assignment: null,
                    usedCharacters: [],
                    initialMaxResets: MAX_RESETS
                };
                localStorage.setItem(STORAGE_KEY, JSON.stringify(allData));
                return allData[castle];
            }

            // Migration logic:
            const data = allData[castle];
            if (!('initialMaxResets' in data) || data.initialMaxResets !== MAX_RESETS) {
                const oldInitial = data.initialMaxResets || prevDefault;
                const used = Math.max(0, oldInitial - (data.resetsLeft ?? 0));
                data.resetsLeft = Math.max(0, MAX_RESETS - used);
                data.initialMaxResets = MAX_RESETS;
                allData[castle] = data;
                localStorage.setItem(STORAGE_KEY, JSON.stringify(allData));
            }

            return allData[castle];
        }

        // Migration all saved castles to use the new MAX_RESETS value while preserving used attempts
        function migrateAllCastles() {
            const allData = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
            const prevDefault = 6;
            let changed = false;

            for (const castle in allData) {
                if (!Object.prototype.hasOwnProperty.call(allData, castle)) continue;
                const data = allData[castle];
                const oldInitial = data.initialMaxResets || prevDefault;
                const used = Math.max(0, oldInitial - (data.resetsLeft ?? 0));
                const newResetsLeft = Math.max(0, MAX_RESETS - used);
                if (newResetsLeft !== data.resetsLeft || data.initialMaxResets !== MAX_RESETS) {
                    data.resetsLeft = newResetsLeft;
                    data.initialMaxResets = MAX_RESETS;
                    allData[castle] = data;
                    changed = true;
                }
            }

            if (changed) {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(allData));
            }
        }

        function saveCastleData(castle, data) {
            const allData = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
            allData[castle] = data;
            localStorage.setItem(STORAGE_KEY, JSON.stringify(allData));
        }

        // --- MODAL HANDLERS ---
        function showModal(titleKey, messageKey, onConfirm, param1 = null, param2 = null) {
            const translations = TRANSLATIONS[currentLang];
            
            let message = translations[messageKey] || messageKey; // Fallback to key if not found
            // Replace placeholders: $1, $2
            if (param1 !== null) message = message.replace('$1', param1);
            if (param2 !== null) message = message.replace('$2', param2);
            
            ELEMENTS.modalTitle.textContent = translations[titleKey] || titleKey;
            ELEMENTS.modalMessage.innerHTML = message;
            
            ELEMENTS.themeModal.classList.remove('hidden');
            setTimeout(() => {
                ELEMENTS.themeModal.style.opacity = '1';
            }, 10);

            // Clone to remove previous event listeners
            const oldConfirm = ELEMENTS.modalConfirm;
            const newConfirm = oldConfirm.cloneNode(true);
            oldConfirm.parentNode.replaceChild(newConfirm, oldConfirm);
            
            const oldCancel = ELEMENTS.modalCancel;
            const newCancel = oldCancel.cloneNode(true);
            oldCancel.parentNode.replaceChild(newCancel, oldCancel);
            
            newConfirm.addEventListener('click', () => {
                hideModal();
                onConfirm(true);
            });

            newCancel.addEventListener('click', () => {
                hideModal();
                onConfirm(false);
            });
            
            ELEMENTS.modalConfirm = newConfirm;
            ELEMENTS.modalCancel = newCancel;
            
            // Re-apply i18n to button text if language was just changed
            setLanguage(currentLang);
        }

        function hideModal() {
            ELEMENTS.themeModal.style.opacity = '0';
            setTimeout(() => {
                ELEMENTS.themeModal.classList.add('hidden');
            }, 300);
        }

        // --- UI & STATUS LOGIC (MODIFIED TO USE i18n keys) ---
        function displayStatus(type, messageKey, param1 = null, param2 = null) {
            const translations = TRANSLATIONS[currentLang];
            let message = translations[messageKey] || messageKey; // Fallback to key if not found
            
            // Replace placeholders: $1, $2
            if (param1 !== null) message = message.replace('$1', param1);
            if (param2 !== null) message = message.replace('$2', param2);
            
            ELEMENTS.statusMessage.innerHTML = `<i class="fa-solid fa-circle-info mr-2"></i> ${message}`;
            ELEMENTS.statusMessage.className = `p-3 rounded-lg mb-6 status-${type}`;
        }
        
        function resetToForm() {
            ELEMENTS.assignBtn.disabled = false;
            ELEMENTS.assignBtn.innerHTML = TRANSLATIONS[currentLang]['assign_code'];
        }

        function displayFinalResult(characterName, gender, isExisting) {
            const translations = TRANSLATIONS[currentLang];
            
            ELEMENTS.resultName.textContent = characterName.toUpperCase();
            
            let charType = 'HAWKINS CREW';
            // Logic to determine specific antagonist type (NOTE: These types are NOT translated here, only the surrounding text)
            if (CHARACTERS.Villain_Neutral.includes(characterName)) {
                if (['The Mind Flayer', 'Demogorgon', 'Demo-Dog'].includes(characterName)) {
                    charType = 'UPSIDE DOWN AGENT (MONSTER)';
                } else if (['Vecna (Henry Creel)', 'Peter Ballard (One)'].includes(characterName)) {
                    charType = 'UPSIDE DOWN AGENT (PRIMARY)';
                } else {
                     charType = 'GOVERNMENT/LAB ANTAGONIST';
                }
            }
            
            // Get the translated gender text and remove HTML tags (like <i>) if present
            const translatedGender = translations[gender.toLowerCase() + '_chars'].replace(/<[^>]*>?/gm, '');

            ELEMENTS.resultCharType.textContent = `(${charType} - ${translatedGender} Pool)`;
            ELEMENTS.assignmentForm.classList.add('hidden');
            ELEMENTS.resultDisplay.classList.remove('hidden');
            
            const castleData = getCastleData(currentCastle);
            ELEMENTS.resetCount.textContent = castleData.resetsLeft;
            
            if(isExisting) {
                displayStatus('info', 'result_welcome', characterName.toUpperCase(), currentCastle);
            } else {
                displayStatus('success', 'result_secured', characterName.toUpperCase());
            }
            
            // Migrate existing castle data if MAX_RESETS was increased
            migrateAllCastles();
            loadCastleAssignments();
            ELEMENTS.resetBtn.disabled = castleData.resetsLeft <= 0; 
        }

        // --- CORE GAME FLOW ---
        function initializeGame() {
            // Setup the translator first
            setupLanguageSelector();
            
            // Set up initial event listeners
            ELEMENTS.selectCastleBtn.addEventListener('click', selectCastle);
            ELEMENTS.assignBtn.addEventListener('click', startAssignment);
            ELEMENTS.shareBtn.addEventListener('click', shareAssignment);
            ELEMENTS.newCastleBtn.addEventListener('click', newCastle);
            
            // Use the custom modal reset flow
            ELEMENTS.resetBtn.addEventListener('click', function() {
                const castleData = getCastleData(currentCastle);
                if (castleData.resetsLeft <= 0) {
                    displayStatus('error', 'status_no_resets');
                    return;
                }
                
                showModal(
                    'modal_override_title', 
                    'status_reset_confirm_msg',
                    (confirmed) => {
                        if (confirmed) {
                            performReset();
                        } else {
                            displayStatus('info', 'status_reset_cancel');
                        }
                    },
                    castleData.resetsLeft,
                    currentCastle
                );
            });

            loadCastleAssignments();
        }

        function selectCastle() {
            const castleName = ELEMENTS.castleInput.value.trim();
            
            if (!castleName) {
                displayStatus('error', 'status_enter_name');
                return;
            }

            currentCastle = castleName;
            const castleData = getCastleData(castleName);
            
            ELEMENTS.currentCastle.textContent = castleName;
            ELEMENTS.castleName.textContent = castleName;
            ELEMENTS.resetCount.textContent = castleData.resetsLeft;
            ELEMENTS.resetCountDisplay.textContent = castleData.resetsLeft;
            
            // UI Transition
            ELEMENTS.castleSelection.classList.add('hidden');
            ELEMENTS.assignmentForm.classList.remove('hidden');
            ELEMENTS.resultDisplay.classList.add('hidden');
            
            // Check for existing assignment
            if (castleData.assignment) {
                currentAssignment = castleData.assignment;
                ELEMENTS.playerGender.value = castleData.assignment.gender || '';
                ELEMENTS.playerGender.disabled = true;
                displayFinalResult(castleData.assignment.characterName, castleData.assignment.gender, true);
                ELEMENTS.assignBtn.disabled = true; 
            } else {
                currentAssignment = null;
                ELEMENTS.playerGender.value = '';
                ELEMENTS.playerGender.disabled = false;
                ELEMENTS.assignBtn.disabled = false;
                displayStatus('info', 'status_ready', castleName);
            }

            // Disable reset button if no resets left
            ELEMENTS.resetBtn.disabled = castleData.resetsLeft <= 0;
        }

        async function startAssignment() {
            const gameName = currentCastle;
            const gender = ELEMENTS.playerGender.value;
            const translations = TRANSLATIONS[currentLang];
            
            if (!gameName || !gender) {
                displayStatus('error', 'status_select_pool');
                return;
            }

            const castleData = getCastleData(currentCastle);
            
            if (castleData.assignment) {
                displayStatus('info', 'status_assignment_exists');
                return;
            }

            ELEMENTS.assignBtn.disabled = true;
            ELEMENTS.assignBtn.innerHTML = translations['spinner_initiating'];

            // Show spinner container and start animation
            ELEMENTS.spinnerContainer.classList.remove('hidden');
            ELEMENTS.spinnerText.classList.add('glitch-anim');
            ELEMENTS.spinnerText.textContent = translations['spinner_upside_down'];
            ELEMENTS.assignmentForm.classList.add('hidden');


            setTimeout(async () => {
                try {
                    const allCharacters = [...CHARACTERS.Male, ...CHARACTERS.Female, ...CHARACTERS.Villain_Neutral];
                    
                    const availablePool = allCharacters
                        .filter(name => !castleData.usedCharacters.includes(name))
                        .filter(name => (gender === 'Male' && (CHARACTERS.Male.includes(name) || CHARACTERS.Villain_Neutral.includes(name))) || 
                                         (gender === 'Female' && (CHARACTERS.Female.includes(name) || CHARACTERS.Villain_Neutral.includes(name))));

                    let pool = availablePool;
                    
                    if (pool.length === 0) {
                        pool = (gender === 'Male' ? CHARACTERS.Male : CHARACTERS.Female).concat(CHARACTERS.Villain_Neutral);
                        displayStatus('warning', 'status_duplicate_warning');
                    }
                    
                    const randomIndex = Math.floor(Math.random() * pool.length);
                    const assignedCharacter = pool[randomIndex];
                    
                    const newAssignment = {
                        gameName: gameName, 
                        characterName: assignedCharacter,
                        gender: gender,
                        timestamp: new Date().toISOString(),
                        castle: currentCastle
                    };

                    castleData.assignment = newAssignment;
                    castleData.usedCharacters.push(assignedCharacter);
                    saveCastleData(currentCastle, castleData);
                    
                    currentAssignment = newAssignment;
                    
                    sendToDiscord(gameName, assignedCharacter, gender, currentCastle);
                    
                    // Stop animation and display final name in spinner area briefly
                    ELEMENTS.spinnerText.classList.remove('glitch-anim');
                    ELEMENTS.spinnerText.textContent = assignedCharacter.toUpperCase();

                    setTimeout(() => {
                        ELEMENTS.spinnerContainer.classList.add('hidden');
                        displayFinalResult(assignedCharacter, gender, false);
                        ELEMENTS.assignBtn.disabled = true; 
                        ELEMENTS.playerGender.disabled = true;
                    }, 1000); // Wait 1 second after name reveal

                    
                } catch (error) {
                    console.error("Assignment failed:", error);
                    ELEMENTS.spinnerContainer.classList.add('hidden');
                    displayStatus('error', 'result_failed');
                    resetToForm();
                }
            }, 1500);
        }

        async function sendToDiscord(operatorName, codeName, characterPool, castle) {
            try {
                const payload = {
                    embeds: [{
                        title: `ğŸ”´ CODE NAME ASSIGNMENT: ${codeName.toUpperCase()}`,
                        description: `Assignment confirmed for Operator **${operatorName}** (Castle: ${castle}).`,
                        fields: [
                            { name: 'OPERATOR ALIAS', value: operatorName, inline: true },
                            { name: 'CODE NAME', value: codeName, inline: true },
                            { name: 'POOL', value: characterPool, inline: true }
                        ],
                        // ST Red color in decimal
                        color: 13369344, 
                        footer: { text: 'ROL Hawkins System | CLASSIFIED TRANSMISSION' },
                        timestamp: new Date().toISOString()
                    }]
                };
                
                await fetch(DISCORD_WEBHOOK, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                return true;
            } catch (error) {
                // If Discord fails, we ensure the local flow continues.
                return false;
            }
        }

        function performReset() {
            const castleData = getCastleData(currentCastle);
            
            castleData.resetsLeft--;
            castleData.assignment = null; 
            saveCastleData(currentCastle, castleData);
            
            currentAssignment = null;
            ELEMENTS.playerGender.disabled = false;
            ELEMENTS.resultDisplay.classList.add('hidden');
            ELEMENTS.assignmentForm.classList.remove('hidden');
            
            ELEMENTS.resetCount.textContent = castleData.resetsLeft;
            ELEMENTS.resetCountDisplay.textContent = castleData.resetsLeft;
            ELEMENTS.resetBtn.disabled = castleData.resetsLeft <= 0;
            
            displayStatus('warning', 'status_reset_complete', castleData.resetsLeft, currentCastle);
            resetToForm();
            loadCastleAssignments();
        }

        function newCastle() {
            currentCastle = null;
            currentAssignment = null;
            ELEMENTS.castleInput.value = '';
            ELEMENTS.assignmentForm.classList.add('hidden');
            ELEMENTS.resultDisplay.classList.add('hidden');
            ELEMENTS.castleSelection.classList.remove('hidden');
            displayStatus('info', 'status_new_castle');
        }

        function shareAssignment() {
            if (!currentAssignment) return;
            
            const shareText = `
ğŸ® ROL CASTLE CHARACTER ASSIGNMENT ğŸ®

CASTLE/ALIAS: ${currentCastle}
CODE NAME: ${currentAssignment.characterName}
POOL: ${currentAssignment.gender}

Assigned via ROL Hawkins System (Resets left: ${getCastleData(currentCastle).resetsLeft})
            `.trim();

            navigator.clipboard.writeText(shareText).then(() => {
                displayStatus('success', 'status_copy_success');
            });
        }

        function loadCastleAssignments() {
            const allData = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
            let html = '';
            
            Object.entries(allData).forEach(([castle, data]) => {
                if (data.assignment) {
                    const translations = TRANSLATIONS[currentLang];
                    const resetsText = translations['resets_left'].replace(':', '');
                    const statusClass = data.resetsLeft === 0 ? 'text-red-600' : 'text-yellow-500'; 

                    html += `
                        <div class="roster-entry border border-red-900 rounded p-3 mb-2 font-mono hover:bg-red-900/30 cursor-pointer" onclick="ELEMENTS.castleInput.value='${castle}'; selectCastle();">
                            <div class="font-bold text-red-400">${castle}</div>
                            <div class="text-xs">
                                <span class="roster-name-glow st-title">${data.assignment.characterName.toUpperCase()}</span> 
                            </div>
                            <div class="text-xs ${statusClass}">${resetsText}: ${data.resetsLeft}/${MAX_RESETS}</div>
                        </div>
                    `;
                }
            });
            
            ELEMENTS.castleAssignments.innerHTML = html || `<p class="text-gray-500 text-center">${TRANSLATIONS[currentLang]['roster_empty']}</p>`;
        }

        // Start the game!
        initializeGame();
    </script>
</body>
</html>